from multiprocessing import Process
from tkinter import *
from tkinter import ttk
import tkinter
import matplotlib
import matplotlib.pyplot as plt
from matplotlib.backends.backend_tkagg import (FigureCanvasTkAgg, 
NavigationToolbar2Tk)
import numpy as np
import pandas as pd

class displayGraph:

    def __init__(self, root, mainframe): 
        
        # initiate variables
        self.mainframe = mainframe
        self.root = root
        self.root.title("Displays Graph")

        self.text = StringVar(self.mainframe, value="Graph Generator")
        self.buttonText = StringVar(self.mainframe, value="Generate")
        self.onOff = BooleanVar(self.mainframe, value=False)

        label = ttk.Label(self.mainframe, textvariable=self.text, font=("Arial", 16))
        label.grid(column=45, row = 15)

        # quit = ttk.Button(self.mainframe, width=20, text="Quit", command=self._quit)
        # quit.grid(column=1000, row=1, sticky=(N,E))

        # buttons
        # launch button
        lb = ttk.Button(self.mainframe, width=20, textvariable=self.buttonText, command=self.closeOrLaunch)
        lb.grid(column=45, row = 30)

    def closeOrLaunch(self):
        if self.onOff.get():
            self.close()
            self.onOff.set(False)
        else:
            self.launch()
            self.onOff.set(True)
    
    def launch(self):
        self.text.set("Graph Launched")
        self.buttonText.set("Close")
        self.fig = plt.figure(figsize=(5,4), dpi=100, layout='constrained')

    def close(self):
        self.text.set("Graph Closed")
        self.buttonText.set("Generate")
        self.fig.clf()

    # def _quit(self):
    #     self.root.quit()
    #     self.root.destroy()


def run_gui():
    root = Tk()
    mainframe = ttk.Frame(root, padding=(10, 10))
    mainframe.grid(column=0, row=0, sticky=(N, W, E, S))
    displayGraph(root, mainframe)
    def on_closing():
        root.quit()
        root.destroy()
    root.protocol("WM_DELETE_WINDOW", on_closing)
    root.mainloop()

if __name__ == "__main__":
    # Start GUI in a separate process. Don't daemonize so it runs independently.
    p = Process(target=run_gui)
    p.start()
    
    while p.is_alive():
        pass
    else:
        p.terminate()
        p.join()